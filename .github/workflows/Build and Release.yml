name: Build SpotveeC

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: macos-latest
    env:
      SPOTURL: https://files.catbox.moe/br15wj.ipa
      EEVEEREPO: whoeevee/EeveeSpotifyReborn
      EEVEETAG: swift6.1.5
      VT_ENABLED: false
      CATBOXHASH_ENABLED: false
      WORKFLOWURL: ${{ github.run_url }}
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: 3.13

      - name: Create Build Components folder
        run: mkdir -p "Build Components"

      - name: Download Orion Packages list
        run: |
          curl -sSL https://repo.chariz.com/Packages -o Packages
          ORIONFILE=$(awk '/Filename:.*Orion.*\.deb/ {print $2}' Packages | head -n1)
          curl -LJO "https://repo.chariz.com/$ORIONFILE"
          mv "$ORIONFILE" "Build Components/"
          echo "orion=Build Components/$ORIONFILE" >> $GITHUB_ENV

      - name: Download Eevee IPA
        run: |
          curl -L $SPOTURL -o "Build Components/spotvee.ipa"
          echo "spotipapath=Build Components/spotvee.ipa" >> $GITHUB_ENV

      - name: Cyan patch process
        run: |
          # Example Cyan patch command
          echo "Running Cyan patch..."
          # Add your real Cyan patch commands here
          # e.g., python3 cyan_patch.py ${{ env.spotipapath }}

      - name: Eevee build process
        run: |
          echo "Building Eevee from repo..."
          git clone https://github.com/${{ env.EEVEEREPO }} EeveeRepo
          cd EeveeRepo
          git checkout ${{ env.EEVEETAG }}
          # Add your Eevee build steps here
          # e.g., ./build.sh

      - name: Upload Build Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: SpotveeC-Build
          path: Build Components/
